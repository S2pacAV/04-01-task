---
marp: true
# Define title slide
_class: invert
_backgroundColor: #4520ab;
_paginate: skip;
_footer: 
# _header: "![](https://elbrusboot.camp/static/newLogo-00ed4b8011624cd94aa1812d35f25088.svg)"
---


<style>
img[alt~="center"] {
  display: block;
  margin: 0 auto;
}
h1 {
  position: absolute;
  left: 50px;
  top: 15px;
  right: 80px;
  height: 70px;
  line-height: 70px;
  margin-bottom: 20px;
  color: #4520ab;
  font-size: 28pt

}
a {
  color: #4520ab;
}
</style>

# –§–∞–∑–∞ 1 ‚Ä¢ –ù–µ–¥–µ–ª—è 3 ‚Ä¢ –í—Ç–æ—Ä–Ω–∏–∫


## –ê–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π ‚Ä¢ Ensembling

---
<!--- backgroundColor: white --->
<!--- paginate: true --->
<!--- header: "![](aux/Elbrus-bootcamp-RU.png)" --->

<style>
header {
    height: 675px;
    right: 20px;
    /* margin-bottom: 80px; */
}
header img {
    height: 60px;
    float: right;
 }
</style>




# –°–µ–≥–æ–¥–Ω—è

* –æ—Ç–≤–µ—Ç–∏–º –Ω–∞ –≤–æ–ø—Ä–æ—Å "–∫–∞–∫ –º–æ–∂–Ω–æ —Å–æ–µ–¥–∏–Ω–∏–Ω—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–¥–µ–ª–µ–π?"
* —Ä–∞–∑–±–µ—Ä–µ–º –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
* —É—Å—Ç–∞–Ω–æ–≤–∏–º –∏ –∑–∞–ø—É—Å—Ç–∏–º —Å–∞–º—ã–µ –º–æ—â–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∞–Ω—Å–∞–º–±–ª—è–º–∏ –º–æ–¥–µ–ª–µ–π

---
<!-- _footer: üìù [Hands-On Machine Learning with Scikit-Learn and TensorFlow: Concepts, Tools, and Techniques to Build Intelligent Systems](https://www.amazon.com/dp/1491962291) -->

# –ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ / Voting

![center h:300](https://miro.medium.com/max/1400/1*I7NsQXwyR36XK62s1iDNzQ.png)

* __Hard voting__: –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—Ç –∫–ª–∞—Å—Å—ã - –≤—ã–±–∏—Ä–∞–µ–º –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ—Ç–Ω—ã–π
* __Soft voting__: –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ - —É—Å—Ä–µ–¥–Ω—è–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø–æ –∫–ª–∞—Å—Å–∞–º 

---
<!-- _footer: üìù [Hands-On Machine Learning with Scikit-Learn and TensorFlow: Concepts, Tools, and Techniques to Build Intelligent Systems](https://www.amazon.com/dp/1491962291) -->

# –ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ / Voting

![center h:500](https://miro.medium.com/max/1400/1*I7NsQXwyR36XK62s1iDNzQ.png)

> –ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å –∑–∞–¥–∞—á–µ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏? 


---

# –ë—É—Ç—Å—Ç—Ä–µ–ø / Bootstrap

![center](https://miro.medium.com/max/1400/1*iH5w0MBdiOlxDOCX6nmqqw.png)

---

# –ë—ç–≥–≥–∏–Ω–≥ / Bagging

1. –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è: —Ñ–æ—Ä–º–∏—Ä—É–µ–º _boostrap_ –≤—ã–±–æ—Ä–∫–∏
    - –û–±—É—á–∞–µ–º –æ–¥–Ω—É –ø—Ä–æ—Å—Ç—É—é –º–æ–¥–µ–ª—å –Ω–∞ –∫–∞–∂–¥–æ–π –≤—ã–±–æ—Ä–∫–µ
2. –ê–≥—Ä–µ–≥–∏—Ä—É–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π


---
<!-- _footer: üêç[`sklearn.ensemble`: scikit-learn.org](https://scikit-learn.org/stable/modules/ensemble.html#forests-of-randomized-trees) -->
# –°–ª—É—á–∞–π–Ω—ã–π –ª–µ—Å / Random Forest 


1. –§–æ—Ä–º–∏—Ä—É–µ–º _N_ boostrap-–≤—ã–±–æ—Ä–æ–∫ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞
2. –û–±—É—á–∞–µ–º __–æ–¥–Ω–æ__ –¥–µ—Ä–µ–≤–æ –Ω–∞ –∫–∞–∂–¥–æ–π –∏–∑ _N_ –≤—ã–±–æ—Ä–æ–∫
3. –î–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∞–≥—Ä–µ–≥–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–∞–∂–¥–æ–≥–æ –¥–µ—Ä–µ–≤–∞: –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ—Ç–Ω—ã–π –∫–ª–∞—Å—Å –≤ —Å–ª—É—á–∞–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, —É—Å—Ä–µ–¥–Ω–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Å–ª—É—á–∞–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏: 
  * –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è - —Å–∞–º—ã–π —á–∞—Å—Ç–æ—Ç–Ω—ã–π –∫–ª–∞—Å—Å
  * –†–µ–≥—Ä–µ—Å—Å–∏—è - —É—Å—Ä–µ–¥–Ω—è–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è


–ü–∞—Ä–∞–º–µ—Ç—Ä—ã
- —á–∏—Å–ª–æ –¥–µ—Ä–µ–≤—å–µ–≤: `n_estimators`
- \+ –≤—Å–µ —Ç–µ –∂–µ, —á—Ç–æ –¥–ª—è –¥–µ—Ä–µ–≤—å–µ–≤



--- 
# –°—Ç–µ–∫–∏–Ω–≥ / Stacking 

1. –†–∞–∑–¥–µ–ª–∏—Ç—å –æ–±—É—á–∞—é—â—É—é –≤—ã–±–æ—Ä–∫—É –Ω–∞ 2 —á–∞—Å—Ç–∏: `train_1` –∏ `train_2`
2. –í—ã–±—Ä–∞—Ç—å _L_ –±–∞–∑–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π, –æ–¥–Ω—É –º–µ—Ç–∞-–º–æ–¥–µ–ª—å
3. –û–±—É—á–∏—Ç—å _L_ –±–∞–∑–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π –Ω–∞ `train_1` 
4. –°–¥–µ–ª–∞—Ç—å _L_ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤ `train_2` 
5. –û–±—É—á–∏—Ç—å –º–µ—Ç–∞-–º–æ–¥–µ–ª—å –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –±–∞–∑–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π

---
# –°—Ç–µ–∫–∏–Ω–≥ / Stacking

![h:500 center](https://i.ibb.co/tJD25sQ/stacking.png) 

---
# –°—Ç–µ–∫–∏–Ω–≥ / Stacking

- –ù—É–∂–Ω–æ –º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö
- –ù—É–∂–Ω–æ –º–Ω–æ–≥–æ –º–æ—â–Ω–æ—Å—Ç–µ–π 
- –ù—É–∂–Ω–æ –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏

- –ó–∞—Ç–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ

`sklearn`: [scikit-learn.org](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.StackingRegressor.html)

üìù[–ü—Ä–æ –Ω–∞—Å—Ç—Ä–æ–π–∫—É –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∞–Ω—Å–∞–º–±–ª–µ–π –º–æ–¥–µ–ª–µ–π –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è](https://habr.com/ru/post/672486/)

---
# –ë—É—Å—Ç–∏–Ω–≥ / Boosting

- –°—Ç—Ä–æ–∏–º –∞–ª–≥–æ—Ä–∏—Ç–º—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
- –ö–∞–∂–¥—ã–π —Å–ª–µ–¥—É—é—â–∏–π –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç —Å—É–º–º–∞—Ä–Ω—É—é –æ—à–∏–±–∫—É –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö
- –†–µ—à–µ–Ω–∏–µ –ø—Ä–∏–Ω–∏–º–∞–µ–º –≤–∑–≤–µ—à–µ–Ω–Ω—ã–º –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ–º

---
# –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥ / AdaBoost

–ë—É—Å—Ç–∏–Ω–≥ –Ω–∞ —Ä–µ—à–∞—é—â–∏—Ö –¥–µ—Ä–µ–≤—å—è—Ö

![center h:400](https://lambda-it.ru/media/editor/bos_20190327103839388149.jpg)

---
# –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥ / AdaBoost

–ë—É—Å—Ç–∏–Ω–≥ –Ω–∞ –ª–∏–Ω–µ–π–Ω—ã—Ö –º–æ–¥–µ–ª—è—Ö

![center h:400](https://ars.els-cdn.com/content/image/3-s2.0-B9780128177365000090-f09-18-9780128177365.jpg)


---
# –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥ / Gradient Boosting

- $x^i$ ‚Äì –º–Ω–æ–∂–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏ –æ–±—ä–µ–º–æ–º $l$
- $y^i$ ‚Äì –∏—Å—Ç–∏–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏
- $a_i(x)$ - $i$-—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º  
- $Q(y, a(x)) = \dfrac{1}{l}\sum_{i=1}^{l}\mathcal{L}(y^i, a(x^i))$ ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å


---
![h:700 center](https://amueller.github.io/ml-training-intro/slides/images/grad_boost_regression_steps.png)

---
# –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥ / Gradient Boosting

- –ù–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã $k$ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, –Ω—É–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å $a_{k+1}$ –∞–ª–≥–æ—Ä–∏—Ç–º c $c_{k+1}$ –≤–µ—Å–æ–º
- –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å –¥–ª—è –æ–¥–Ω–æ–≥–æ $i$-–≥–æ –æ–±—ä–µ–∫—Ç–∞: 
$$
\mathcal{L(y^i, a(x^i)) = \mathcal{L}(y^i, c_1 a_1(x^i) + \dots + c_{k}a_{k}(x^i) + {c_{k+1}a_{k+1}(x^i)}})
$$

---
<!-- _footer: üìù [Gradient boosting: Distance to target](https://explained.ai/gradient-boosting/L2-loss.html) -->

# –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥ / Gradient Boosting

![center h:400](https://explained.ai/gradient-boosting/images/golf-dir-vector.png)


---
# –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥ / Gradient Boosting

- –ë–∞–∑–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ª—é–±—ã–º–∏, –Ω–æ –ª—É—á—à–µ –¥–µ—Ä–µ–≤—å—è–º–∏
- –†–µ—à–∞–µ—Ç –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, —Ä–µ–≥—Ä–µ—Å—Å–∏–∏, —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è (–Ω–µ –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ)
- –ù—É–∂–Ω–∞ –±–æ–ª—å—à–∞—è –≤—ã–±–æ—Ä–∫–∞
- –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏: 


  - `sklearn.ensemble`: [scikit-learn.org](https://scikit-learn.org/stable/auto_examples/ensemble/plot_gradient_boosting_regression.html) 
  - Extreme Gradient Boosting / `xgboost`: [xgboost.readthedocs.io](https://xgboost.readthedocs.io/) 
  - Light Gradient Boosting Machine / `lighgbm`: [lightgbm.readthedocs.io](https://lightgbm.readthedocs.io/en/latest/)
  - Categorical Boosting / `catboost`: [catboost.ai](https://catboost.ai/)
  - –ü—Ä–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∏ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å —Ç—É—Ç: 
    * [CatBoost vs. Light GBM vs. XGBoost](https://towardsdatascience.com/catboost-vs-light-gbm-vs-xgboost-5f93620723db)
    * [When to Choose CatBoost Over XGBoost or LightGBM [Practical Guide]](https://neptune.ai/blog/when-to-choose-catboost-over-xgboost-or-lightgbm)


---

# –ò—Ç–æ–≥–∏

- **Voting**: –±–µ—Ä–µ–º –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏, –∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–≥—Ä–µ–≥–∏—Ä—É–µ–º –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º –æ–±—Ä–∞–∑–æ–º
- **–ë—ç–≥–≥–∏–Ω–≥**: —Å—Ç—Ä–æ–∏–º –±—É—Å—Ç—Ä–µ–ø –ø–æ–¥–≤—ã–±–æ—Ä–∫–∏ –∏ –æ–±—É—á–∞–µ–º –ø—Ä–æ—Å—Ç—ã–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –∫–∞–∂–¥–æ–π –∏–∑ –≤—ã–±–æ—Ä–æ–∫ 
  - –ø—Ä–∏–º–µ—Ä: —Å–ª—É—á–∞–π–Ω—ã–π –ª–µ—Å
- **–°—Ç–µ–∫–∏–Ω–≥**: –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–µ—Ç–∞-–º–æ–¥–µ–ª–∏
- **–ë—É—Å—Ç–∏–Ω–≥**: –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —Å—Ç—Ä–æ–∏–º –º–æ–¥–µ–ª–∏, –∫–∞–∂–¥–∞—è —Å–ª–µ–¥—É—é—â–∞—è –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –æ—à–∏–±–∫—É –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö
  - –ë—É—Å—Ç–∏–Ω–≥ –ø–æ–∫–∞ –µ—â–µ [–ª—É—á—à–µ–µ](https://arxiv.org/pdf/2110.01889.pdf) —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö