---
marp: true
# Define title slide
_class: invert
_backgroundColor: #4520ab;
_paginate: skip;
_footer: 
# _header: "![](https://elbrusboot.camp/static/newLogo-00ed4b8011624cd94aa1812d35f25088.svg)"
---


<style>
img[alt~="center"] {
  display: block;
  margin: 0 auto;
}
h1 {
  position: absolute;
  left: 77px;
  top: 15px;
  right: 80px;
  height: 70px;
  line-height: 70px;
  margin-bottom: 20px;
  color: #4520ab;
  font-size: 28pt
}
a {
  color: #4520ab;
}
</style>
# –§–∞–∑–∞ 1 ‚Ä¢ –ù–µ–¥–µ–ª—è 3 ‚Ä¢ –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫

## –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ ‚Ä¢ –û—Å–Ω–æ–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã


---
<!--- backgroundColor: white --->
<!--- paginate: true --->
<!--- header: "![](aux/Elbrus-bootcamp-RU.png)" --->

<style>
header {
    height: 675px;
    right: 20px;
    /* margin-bottom: 80px; */
}
header img {
    height: 60px;
    float: right;
 }
</style>

# –°–µ–≥–æ–¥–Ω—è

* —Ä–∞–∑–±–µ–∑—Ä–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
* –æ—Ç–≤–µ—Ç–∏–º –Ω–∞ –≤–æ–ø—Ä–æ—Å "–∫–∞–∫–æ–π –ø—Ä–∏–∑–Ω–∞–∫ —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π?"
* –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã

---

<!-- _footer: üìù [KNN classifier](https://matlab1.com/knn-classifier/) -->

# –ú–µ—Ç–æ–¥ –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π 

![center h:350](https://upload.wikimedia.org/wikipedia/commons/thumb/e/e7/KnnClassification.svg/1920px-KnnClassification.svg.png) 



---

# –ú–µ—Ç–æ–¥ –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π / KNN

* –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è: 
    * –±–µ—Ä–µ–º $k$ —Å–æ—Å–µ–¥–µ–π –∏ —Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫–æ–π –∫–ª–∞—Å—Å –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —á–∞—â–µ
* —Ä–µ–≥—Ä–µ—Å—Å–∏—è:
    * –±–µ—Ä–µ–º –∏ –≤—ã—á–∏—Å–ª—è–µ–º —Å—Ä–µ–¥–Ω–µ–µ (–º–æ–∂–Ω–æ —Å—Ä–µ–¥–Ω–µ–≤–∑–≤–µ—à–µ–Ω–Ω–æ–µ) –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –Ω–æ–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞

---


# –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ

* –ß—Ç–æ –∑–Ω–∞—á–∏—Ç –±–ª–∏–∂–∞–π—à–∏–µ?

–ë–ª–∏–∑–∫–∏–µ –ø–æ –º–µ—Ç—Ä–∏–∫–µ –ú–∏–Ω–∫–æ–≤—Å–∫–æ–≥–æ: 

$$\rho(x, y) = \left( \sum^{d}_{i=0} |x_i - y_i|^p \right)^{1/p}$$

‚Ä¢ –ø—Ä–∏ $p=2$ —ç—Ç–æ –µ–≤–∫–ª–∏–¥–æ–≤–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ 
‚Ä¢ –ø—Ä–∏ $p=1$ –ú–∞–Ω—Ö—ç—Ç—Ç–µ–Ω—Å–∫–∞—è –º–µ—Ç—Ä–∏–∫–∞
‚Ä¢ –ø—Ä–∏ $p=\infty$ - –º–µ—Ç—Ä–∏–∫–∞ –ß–µ–±—ã—à–µ–≤–∞ (–Ω–∞–∏–±–æ–ª—å—à–µ–µ –∏–∑ –≤—Å–µ—Ö —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π)

---

# –ú–µ—Ç–æ–¥ –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π: –ø—Ä–æ–±–ª–µ–º–∞

![center h:380 w:600](https://miro.medium.com/max/938/1*OhaHs0Lb0_AVLGft2dgktA.png)

–ï—Å–ª–∏ —Ü–µ–ª–µ–≤–æ–π –æ–±—ä–µ–∫—Ç —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –¥–∞–ª–µ–∫–æ, –∞–ª–≥–æ—Ä–∏—Ç–º –≤—Å–µ —Ä–∞–≤–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –æ–±—ä–µ–∫—Ç. –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–¥–∏–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç. 

---
<!-- _footer: üìù [r-Nearest neighbors](https://www.geeksforgeeks.org/r-nearest-neighbors/)
 -->
# –†–∞–¥–∏–∞–ª—å–Ω—ã–π NN / RadiusNN

![center h:400](https://media.geeksforgeeks.org/wp-content/uploads/20190614212554/download-310.png)

–ù–æ —Ç–∞–∫–æ–π —Ä–∞–¥–∏—É—Å —Å–ª–æ–∂–Ω–æ –ø–æ–¥–æ–±—Ä–∞—Ç—å. 


--- 
# KNN: –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã

* —á–∏—Å–ª–æ —Å–æ—Å–µ–¥–µ–π / —Ä–∞–¥–∏—É—Å
* –º–µ—Ç—Ä–∏–∫–∞ 
* —Å–ø–æ—Å–æ–± –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤–µ—Å–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤

--- 


# Decision Tree
* –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è: –∏–≥—Ä–∞ —Å–æ—Å—Ç–æ–∏—Ç—Å—è? 

![h:500 center](https://www.includehelp.com/ml-ai/Images/decision-trees-1.jpg)

---

# –ö–∞–∫–æ–π –ø—Ä–∏–∑–Ω–∞–∫ —Å–∞–º—ã–π –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–π? 



–¢–æ—Ç, –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, –º—ã –ø–æ–ª—É—á–∞–µ–º –Ω–∞–∏–±–æ–ª–µ–µ "—á–∏—Å—Ç—ã–µ" –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–æ–≤ –≤—ã–±–æ—Ä–∫–∏: 

- –ü—Ä–∏–∑–Ω–∞–∫ `Windy` –∏–º–µ–µ—Ç –¥–≤–∞ –∑–Ω–∞—á–µ–Ω–∏—è: `Weak` –∏ `Strong`
    - –î–ª—è `Windy=Weak`: `Play=Yes` ‚Äì 3 –æ–±—ä–µ–∫—Ç–∞, `Play=No` ‚Äì  1 –æ–±—ä–µ–∫—Ç 
    - –î–ª—è `Windy=Strong`: `Play=Yes` ‚Äì 2 –æ–±—ä–µ–∫—Ç–∞, `Play=No` ‚Äì  4 –æ–±—ä–µ–∫—Ç–∞

- –ü—Ä–∏–∑–Ω–∞–∫ `Humidity` –∏–º–µ–µ—Ç –¥–≤–∞ –∑–Ω–∞—á–µ–Ω–∏—è: `High` –∏ `Normal`:
    - –î–ª—è `Humidity=Normal`: `Play=Yes` ‚Äì 2 –æ–±—ä–µ–∫—Ç–∞, `Play=No` ‚Äì  1 –æ–±—ä–µ–∫—Ç
    - –î–ª—è `Humidity=High`: `Play=Yes` ‚Äì 3 –æ–±—ä–µ–∫—Ç–∞, `Play=No` ‚Äì  4 –æ–±—ä–µ–∫—Ç

--- 
# –û—Ü–µ–Ω–∫–∏ –≥–æ–º–æ–≥–µ–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–∑–±–∏–µ–Ω–∏–π
</br>


![h: 1500 center](https://i.ibb.co/r2vPZCW/Decision-Tree-Page-1.png)

–ö–∞–∫ –∏–∑–º–µ—Ä–∏—Ç—å –≥–æ–º–æ–≥–µ–Ω–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–∫–∏ –≤ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —Ä–∞–∑–±–∏–µ–Ω–∏—è—Ö?

- –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –î–∂–∏–Ω–∏ / Gini impurity: 
$$G = 1 - \Sigma_i p_i^2$$
- –≠–Ω—Ç—Ä–æ–ø–∏—è —Ä–∞–∑–±–∏–µ–Ω–∏—è:
$$H=- \Sigma p_i \log_2{p_i}$$
$p_i$ ‚Äì —á–∞—Å—Ç–æ—Ç–∞ –æ–±—ä–µ–∫—Ç–æ–≤ –∫–ª–∞—Å—Å–∞ $i$ –≤ —Ä–∞–∑–±–∏–µ–Ω–∏–∏

---
# –ò—Å—Ö–æ–¥–Ω–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ

|–†–∞–∑–±–∏–µ–Ω–∏–µ| Entropy|
|-------|--------------|
|–ò—Å—Ö–æ–¥–Ω–æ–µ ![w:120](https://i.ibb.co/cwFYLQp/Decision-Tree-Page-2.png)| $-(0.5 \log_2{0.5} + 0.5 \log_2{0.5)}=1$|
|`Windy=Weak` ![](https://i.ibb.co/8BMxTwh/Decision-Tree-Page-3.png)|$-(0.25\log_2{0.25} + 0.75\log_2{0.75)}=0.81$
|`Windy=Strong` ![](https://i.ibb.co/QH60SL7/Decision-Tree-Page-4.png)|$-(0.33\log_2{0.33} + 0.66\log_2{0.66)=0.92}$|

---
# Information gain
$$IG = S_0 - \sum_{i=1}^{q}\dfrac{N_i}{N}S_i,$$ 
- $q$ ‚Äì —á–∏—Å–ª–æ –ª–∏—Å—Ç—å–µ–≤ (–æ–±—ã—á–Ω–æ 2), 
- $N_i$ ‚Äì —á–∏—Å–ª–æ –æ–±—ä–µ–∫—Ç–æ–≤, –ø–æ–ø–∞–≤—à–∏—Ö –≤ $i$-–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ, 
- $N$ ‚Äì –æ–±—â–µ–µ —á–∏—Å–ª–æ –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –≤–µ—Ä–∏—à–Ω–µ –æ–±—ä–µ–∫—Ç–æ–≤, 
- $S_0$ ‚Äì _impurity metric_ (_gini_ –∏–ª–∏ _entropy_) –¥–ª—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ä–∞–∑–±–∏–µ–Ω–∏—è, 
- $S_i$ ‚Äì _impurity metric_ –¥–ª—è $i$-–≥–æ —Ä–∞–∑–±–∏–µ–Ω–∏—è.

–î–ª—è —Ä–∞–∑–±–∏–µ–Ω–∏—è, –ø–æ—Å—Ç—Ä–æ–æ–µ–Ω–Ω–æ–≥–æ –ø–æ –ø—Ä–∏–∑–Ω–∞–∫—É `Windy`: 
$$IG = 1 - 0.4 \times 0.81 - 0.6 \times 0.92 = 0.12$$

---
<!-- _footer: ¬©Ô∏è[Feature Importances](https://www.scikit-yb.org/en/latest/api/model_selection/importances.html) -->
# –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ ‚Ä¢ Feature importances

–°—É–º–º–∞—Ä–Ω—ã–π (–∞ –≤ `sklearn` –∏ –Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π) –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å —É–º–µ–Ω—å—à–µ–Ω–∏—è –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω–æ—Å—Ç–∏ –≤—ã–±–æ—Ä–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤: –µ—Å–ª–∏ –ø—Ä–∏–∑–Ω–∞–∫ –≤—ã–±–∏—Ä–∞–ª—Å—è —á–∞—Å—Ç–æ –∏ —Å–∏–ª—å–Ω–æ —É–º–µ–Ω—å—à–∞–ª —ç–Ω—Ç—Ä–æ–ø–∏—é –∏–ª–∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –î–∂–∏–Ω–∏, —Ç–æ –æ–Ω —è–≤–ª—è–µ—Ç—Å—è **–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º**. 

![center h:350](https://www.scikit-yb.org/en/latest/_images/importances-1.png)

---
# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–µ—à–∞—é—â–∏—Ö –¥–µ—Ä–µ–≤—å–µ–≤
- –ö—Ä–∏—Ç–µ—Ä–∏–π –≤–µ—Ç–≤–ª–µ–Ω–∏—è: `criterion: gini, entropy`
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞: `max_depth`
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –ª–∏—Å—Ç–µ: `min_samples_leaf`
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —É–º–µ–Ω—å—à–µ–Ω–∏—è –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è –æ—Å—É—â–µ—Å—Ç–≤–ª–µ–Ω–∏—è –¥–µ–ª–µ–Ω–∏—è: `min_impurity_decrease`

`sklearn.tree`: [https://scikit-learn.org/stable/modules/tree.html](https://scikit-learn.org/stable/modules/tree.html)

---
# –ò—Ç–æ–≥–∏


* –¥–µ—Ä–µ–≤—å—è - –º–æ—â–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º
* –Ω–æ —Å–∫–ª–æ–Ω–µ–Ω –∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—é
* –º–æ–∂–µ—Ç –≤—ã—Å—Ç—É–ø–∞—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å–æ—Å—Ç–∞–≤–Ω–æ–≥–æ –±–ª–æ–∫–∞ –¥–ª—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –∫–æ–Ω—Ü–µ–ø—Ü–∏–π - –æ–± —ç—Ç–æ–º –∑–∞–≤—Ç—Ä–∞
* —É –æ–±—É—á–µ–Ω–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞ –µ—Å—Ç—å –∞—Ç—Ä–∏–±—É—Ç: `model.feature_importances_`
* –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∑–∞–¥–∞—á —Ä–µ–≥—Ä–µ—Å—Å–∏–∏: 
  * üìù[CART](https://ru.wikipedia.org/wiki/CART_(%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC)): classification and regression trees
  * ‚ÄºÔ∏èüìù[A Step By Step Regression Tree Example](https://sefiks.com/2018/08/28/a-step-by-step-regression-decision-tree-example/)


